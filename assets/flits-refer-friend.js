window.flitsApp&& void 0!==window.flitsApp||(window.flitsApp={}),window.flitsApp.refer_friend&& void 0!==window.flitsApp.refer_friend||(window.flitsApp.refer_friend={}),window.flitsApp.getURLParameter=function(a){return decodeURIComponent((new RegExp("[?|&]"+a+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[null,""])[1].replace(/\+/g,"%20"))||null},window.flitsApp.closeReferralModal=function(){return document.querySelector("#flits-referral-modal").style.display="none",document.querySelector("#flits-referral-modal")},window.flitsApp.openReferralModal=function(){return window.flitsApp.setCookie("flits-referral-popup-closed","1",1),document.querySelector("#flits-referral-modal").style.display="block",document.querySelector("#flits-referral-modal")},window.flitsApp.addContentReferralModal=function(a){return document.querySelector("#flits-referral-modal .flits-referral-content .flits-content").innerHTML=a,document.querySelector("#flits-referral-modal")},window.flitsApp.getCookie=function(e){for(var c=e+"=",d=decodeURIComponent(document.cookie).split(";"),b=0;b<d.length;b++){for(var a=d[b];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(c))return a.substring(c.length,a.length)}return""},window.flitsApp.setCookie=function(b,c,d){var a=new Date;a.setTime(a.getTime()+864e5*d);var e="expires="+a.toUTCString();document.cookie=b+"="+c+";"+e+";path=/"},window.flitsApp.isNull=function(a){return void 0===a||null==a||""==a.trim()},window.flitsApp.run_after_jquery=function(a){var b=setInterval(function(){"undefined"==typeof flitsAppJquery||(clearInterval(b),"function"==typeof a&&a())},1e3)},window.flitsApp.referFriend=function(){var a=this;this.getReferralData=function(){var b="/refer_friend/get_referral_data";b=flitsAppJquery("#flits-customer-url").val()+b,flitsAppJquery.ajax({url:b,method:"get",data:{customer_hash:window.flitsApp.customer_hash,token:flitsAppJquery("#flits-token").val()},success:function(b){if(b.status){flitsAppJquery(".flits-loading-div").hide(),flitsAppJquery(".flits-refer-friend-content").show();var g=flitsAppJquery("#flits-shop-money-format").val(),c=b.customer,e=b.customer.credit_log;if(""!=c.referral_code){flitsAppJquery(".flits-refferal-code-div").html(c.referral_code);var h="https://"+location.host+"/account/register?flits_refer_code="+encodeURIComponent(unescape(btoa(c.referral_code)))+"&flits_inviter_name="+encodeURIComponent(unescape(btoa(c.name)));flitsAppJquery(".flits-referral-link").val(h)}else flitsAppJquery(".flits-referrer-code").val(window.flitsApp.multilang_refer_friend.referral_code_not_available),flitsAppJquery(".flits-referrer-code-copy-btn-div").addClass("flits-hidden");""!=b.refer_by&&(flitsAppJquery(".flits-referee-inner-div").addClass("flits-hidden"),flitsAppJquery(".flits-refer-by").removeClass("flits-hidden"),flitsAppJquery(".flits-referred-by").html(b.refer_by)),"function"==typeof navigator.share&&flitsAppJquery(".flits-referral-navigator-share").removeClass("flits-hidden"),b.facebook_share&&flitsAppJquery(".flits-referral-facebook-share").removeClass("flits-hidden"),b.whatsapp_share&&flitsAppJquery(".flits-referral-whatsapp-share").removeClass("flits-hidden");var d=0;e.length>0?(flitsAppJquery.each(e,function(h,a){var b=flitsAppJquery("#flits-refer-program-credit-log-template").clone();b.attr("id","flits-log-"+a.id);var c=a.credits;d+=c,c=window.flitsApp.multilang.earned+" "+window.flitsApp.formatMoney(Math.abs(c),g).replace(/((\,00)|(\.00))$/g,""),b.find(".flits-referral-customer-credit-col").html(c);var f=window.flitsApp.multilang_refer_friend.customer_deleted,e="--";null!=a.referrer_customer&&(f=a.referrer_customer.name,e=a.referrer_customer.email),b.find(".flits-referral-customer-name-col").html(f),b.find(".flits-referral-customer-email-col").html(e).attr("title",e),b.find(".flits-referral-customer-credit-date-col").html(a.created_at),flitsAppJquery(".flits-refer-program-credit-log").append(b)}),flitsAppJquery(".flits-refer-program-credit-history-div").removeClass("flits-hidden"),flitsAppJquery(".flits-refer-program-credit-history-empty").addClass("flits-hidden")):(flitsAppJquery(".flits-refer-program-credit-history-empty").removeClass("flits-hidden"),flitsAppJquery(".flits-refer-program-credit-history-div").addClass("flits-hidden")),d=window.flitsApp.formatMoney(Math.abs(d),g).replace(/((\,00)|(\.00))$/g,""),flitsAppJquery(".flits-refer-program-total-credits").html(d)}else{var f="";switch(b.error_code){case 2:case 3:flitsAppJquery(".flits-refer-friend-content").hide(),flitsAppJquery(".flits-loading-div").show(),f=window.flitsApp.multilang_refer_friend.loading_message,flitsAppJquery(".flits-loading-message").html(f),setTimeout(function(){a.getReferralData()},2e3);break;default:flitsAppJquery('.flits-nav a[data-href="#flits-page-refer-friend"]').remove(),flitsAppJquery("#flits-page-refer-friend").remove()}}},error:function(a){a.status,flitsAppJquery("#flits-page-refer-friend").toast(a.statusText)}})},this.copyReferrerCode=function(){flitsAppJquery(".flits-referrer-container").toast(window.flitsApp.multilang_refer_friend.referral_code_copied),flitsAppJquery(".flits-referral-link").select(),document.execCommand("copy")},this.sendReferRequest=function(){flitsApp.showLoading(window.flitsApp.multilang_refer_friend.refer_friend_loading,flitsAppJquery(".flits-referee-div")),flitsAppJquery(".flits-refer-friend-error-div").addClass("flits-hidden"),flitsAppJquery(".flits-refer-loader").removeClass("flits-hidden");var b=flitsAppJquery("#flits-refer-friend-code").val();if(""!=b){var a="/refer_friend/send_refer_request";a=flitsAppJquery("#flits-customer-url").val()+a,flitsAppJquery.ajax({url:a,method:"POST",data:{customer_hash:window.flitsApp.customer_hash,token:flitsAppJquery("#flits-token").val(),refer_friend_code:b},success:function(b){if(flitsAppJquery(".flits-refer-loader").addClass("flits-hidden"),b.status)flitsAppJquery(".flits-referee-div").toast(window.flitsApp.multilang_refer_friend.successfully_refer_friend),-1!=b.data.inviter.name&&(flitsAppJquery(".flits-enter-referral-code-label").addClass("flits-hidden"),flitsAppJquery(".flits-referee-inner-div").addClass("flits-hidden"),flitsAppJquery(".flits-refer-by").removeClass("flits-hidden"),flitsAppJquery(".flits-referred-by").html(b.refer_by));else{flitsAppJquery(".flits-refer-friend-error-div").removeClass("flits-hidden");var a="";switch(b.error_code){case 1:a=window.flitsApp.multilang_refer_friend.you_can_not_referred_yourself;break;case 2:default:a=window.flitsApp.multilang_refer_friend.something_went_wrong;break;case 3:a=window.flitsApp.multilang_refer_friend.invalid_referral_code;break;case 4:a=window.flitsApp.multilang_refer_friend.refer_program_not_active}flitsAppJquery(".flits-referee-div").toast(a)}},error:function(a){a.status}})}else flitsAppJquery(".flits-referee-div").toast(window.flitsApp.multilang_refer_friend.referral_code_is_required),flitsAppJquery(".flits-refer-loader").addClass("flits-hidden"),flitsAppJquery(".flits-refer-friend-error-div").removeClass("flits-hidden")},this.popupWindow=function(d,e,a,b,c){let f=a.top.outerHeight/2+a.top.screenY-c/2,g=a.top.outerWidth/2+a.top.screenX-b/2;return a.open(d,e,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+b+", height="+c+", top="+f+", left="+g)},this.getReferralData(),flitsAppJquery(document).on("click",".flits-send-refer-request-btn",function(b){a.sendReferRequest()}),flitsAppJquery(document).on("click",".flits-referral-link-copy",function(b){a.copyReferrerCode()}),flitsAppJquery(document).on("click",".flits-referral-link-share",function(i){var c=flitsAppJquery(this).attr("data-flits-share-platform"),d=flitsAppJquery(".flits-referral-link").val(),e=encodeURIComponent(unescape(window.flitsApp.multilang_refer_friend.referral_program_invitation_message.replace("##link##",""))),f=encodeURIComponent(unescape(window.flitsApp.multilang_refer_friend.referral_program_invitation_message.replace("##link##",d))),g=window.flitsApp.multilang_refer_friend.referral_program_invitation_message.replace("##link##",d),b=null;switch(c){case"facebook":b="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(unescape(d))+"&quote="+e;break;case"whatsapp":b="https://api.whatsapp.com/send?text="+f;break;case"navigator_share":var h={title:"Refer Freind",text:g};return navigator.share(h),!0}b&&a.popupWindow(b,c.charAt(0).toUpperCase()+c.slice(1)+" Share",window,700,700)})},window.flitsApp.append_anchor_div=function(c){if("/account"==location.pathname){var d=document.querySelector(".flits-pages"),b=document.querySelector(".flits-refer-friend .flits-anchor a"),e=document.querySelector(".flits-refer-friend .flits-div div");if(b){var f=document.querySelector(".flits-list-group").children.length,a=document.querySelector(".flits-list-group");c>=f?a.insertBefore(b,a.children[f]):a.insertBefore(b,a.children[c])}e&&d&&d.append(e),window.flitsApp.run_after_jquery(window.flitsApp.referFriend)}},window.flitsApp.multilang_refer_friend.refer_friend_rule_on&&1==window.flitsApp.multilang_refer_friend.refer_friend_rule_on&&window.flitsApp.append_anchor_div(4);var is_new_to_referral=!1;if(window.flitsApp.isNull(window.flitsApp.getURLParameter("flits_refer_code"))&&window.flitsApp.isNull(window.flitsApp.getCookie("flits-referral-code"))|| -1!=window.flitsApp.refer_friend.customer_id||(is_new_to_referral=!0),is_new_to_referral){var g,a=null,b="";window.flitsApp.isNull(window.flitsApp.getURLParameter("flits_refer_code"))||(a=atob(window.flitsApp.getURLParameter("flits_refer_code")),window.flitsApp.setCookie("flits-referral-code",a,1)),window.flitsApp.isNull(window.flitsApp.getURLParameter("flits_inviter_name"))||(b=atob(window.flitsApp.getURLParameter("flits_inviter_name")),window.flitsApp.setCookie("flits-inviter-name",b,1)),window.flitsApp.isNull(window.flitsApp.getCookie("flits-referral-code"))||(a=window.flitsApp.getCookie("flits-referral-code")),window.flitsApp.isNull(window.flitsApp.getCookie("flits-inviter-name"))||(b=window.flitsApp.getCookie("flits-inviter-name")),window.flitsApp.addContentReferralModal(window.flitsApp.multilang_refer_friend.popup_message.replace(/##inviter_name##/g,b)),window.flitsApp.isNull(window.flitsApp.getCookie("flits-referral-popup-closed"))&&window.flitsApp.openReferralModal();for(var f=document.querySelectorAll(".flits-btn"),e=0;e<f.length;e++)f[e].href+="&flits_refer_code="+a;var c=document.querySelector('form[method="post"][action="/account"]');if(c){var d=document.createElement("input");d.type="hidden",d.name="customer[note][flits_referral_code]",d.value=a,c.querySelector('[name="customer[note][flits_referral_code]"]')?c.querySelector('[name="customer[note][flits_referral_code]"]').value=a:c.appendChild(d)}window.history.replaceState({},document.title,location.protocol+"//"+location.host+location.pathname)}-1!=window.flitsApp.refer_friend.customer_id&&window.flitsApp.setCookie("flits-referral-code","",-1),document.querySelector(".flits-close").onclick=function(){window.flitsApp.closeReferralModal()},window.onclick=function(a){a.target==document.querySelector("#flits-referral-modal")&&window.flitsApp.closeReferralModal()}